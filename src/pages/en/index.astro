---
import AboutSection from '../../components/home/AboutSection.astro';
import CallToActionSection from '../../components/home/CallToActionSection.astro';
import GiftCardSection from '../../components/home/GiftCardSection.astro';
import HeroSection from '../../components/home/HeroSection.astro';
import LocationSection from '../../components/home/LocationSection.astro';
import ReviewsSection from '../../components/home/ReviewsSection.astro';
import ServicesSection from '../../components/home/ServicesSection.astro';
import SubscriptionsSection from '../../components/home/SubscriptionsSection.astro';
import MainLayout from '../../layouts/MainLayout.astro';
import { getLangFromUrl } from '../../i18n/utils';
import { getSortedServiceCategories, getHomepageConfig, getSiteConfig, getReviews } from '../../utils/content';
import { METADATA } from 'astrowind:config';

const lang = getLangFromUrl(Astro.url);
const siteConfig = getSiteConfig(lang);
const homepageConfig = getHomepageConfig(lang);
const reviews = getReviews(lang);

const serviceCategories = getSortedServiceCategories(lang);
const { hero, about, services, subscriptions, subscriptionAction, giftCard, social, callToAction, location } = homepageConfig;
const pageTitle = `${siteConfig.brand.name} Â· ${siteConfig.brand.tagline}`;
const pageDescription = hero.subtitle[0] ?? siteConfig.brand.description;

// Get OG image URL directly from config (served from public folder)
const ogImagePath = METADATA?.openGraph?.images?.[0]?.url;
const ogImageUrl = ogImagePath && Astro.site ? new URL(ogImagePath, Astro.site).href : null;
---

<MainLayout title={pageTitle} description={pageDescription} image={ogImageUrl}>
  <HeroSection hero={hero} />
  <AboutSection about={about} />
  <ServicesSection content={services} categories={serviceCategories} />
  <SubscriptionsSection subscriptions={subscriptions} action={subscriptionAction} />
  <GiftCardSection giftCard={giftCard} />
  <ReviewsSection reviews={reviews} />
  <CallToActionSection block={callToAction} />
  <LocationSection location={location} social={social} />

</MainLayout>
